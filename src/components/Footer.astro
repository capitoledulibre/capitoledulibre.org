---
import CapitoleDuLibre from "@assets/logo-capitoledulibre.svg";
import { Icon } from "astro-icon/components";

let links = {
  github: "https://github.com/capitoledulibre",
  mastodon: "https://framapiaf.org/@capitoledulibre",
  bluesky: "https://bsky.app/profile/capitoledulibre.org",
  x: "https://x.com/capitoledulibre",
  linkedin: "https://www.linkedin.com/company/capitole-du-libre/",
  instagram: "https://www.instagram.com/capitoledulibre/",
  facebook: "https://www.facebook.com/CapitoleDuLibre/",
};

let editions = [
  2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2022, 2023, 2024, 2025,
];
---

<footer>
  <div class="container">
    <div class="logo">
      <CapitoleDuLibre class="logo" />
      <div class="links">
        {
          Object.entries(links).map(([key, value]) => (
            <a href={value} target="_blank" rel="noopener noreferrer">
              <Icon name={`simple-icons:${key}`} />
            </a>
          ))
        }
      </div>
      <div class="year">
        © Toulibre <span>-</span> Edition
        <div class="dropdown">
          <button class="dropdown-toggle" id="dropdown-toggle">
            {editions.slice(-1)[0]} ▾
          </button>
          <div class="dropdown-content" id="dropdown-content">
            {
              editions
                .slice(0, -1)
                .map((edition) => (
                  <a href={`https://${edition}.capitoledulibre.org`}>
                    {edition}
                  </a>
                ))
            }
          </div>
        </div>
      </div>
    </div>

    <div class="copyright"></div>

    <script>
      const toggle = document.getElementById("dropdown-toggle");
      const content = document.getElementById("dropdown-content");

      toggle?.addEventListener("click", (e) => {
        e.stopPropagation();
        content?.classList.toggle("active");
      });

      document.addEventListener("click", () => {
        content?.classList.remove("active");
      });
    </script>

    <style>
      footer {
        color: white;
        background-color: var(--accent-gradient);
        padding: 20px;
        text-align: center;

        .container {
          max-width: 500px;
          margin: 0 auto;
        }

        svg.logo {
          max-height: 150px;
          margin-top: 1em;

          & > g {
            fill: white;
          }
        }

        .year {
          font-size: 1.3em;
          margin-bottom: 2em;
          padding-top: 0em;
          text-align: center;

          span {
            padding: 0 0.5em;
          }
        }

        .links {
          margin: 1em 0;
          display: flex;
          flex-wrap: wrap;
          gap: 32px;
          justify-content: center;
          font-size: 2em;

          a {
            color: white;
            text-decoration: none;
            transition: all 0.2s ease-in-out;

            &:hover {
              color: var(--secondary);
            }
          }
        }
      }

      .links {
        display: flex;
        gap: 32px;
        justify-content: center;
        font-size: 2em;
      }

      .dropdown {
        position: relative;
        display: inline-block;
      }

      .dropdown-toggle {
        color: white;
        background: transparent;
        padding: 0.3rem 0.8rem;
        border: none;
        cursor: pointer;
        font: inherit;
        border-radius: 4px;
        border: 1px solid #ddd;
        transition: all 0.2s ease-in-out;

        &:hover {
          background-color: color-mix(
            in srgb,
            var(--secondary) 20%,
            transparent
          );
        }
      }

      .dropdown-content {
        display: none;
        position: absolute;
        bottom: 100%;
        left: -15%;
        margin: 0 0.8em;
        background-color: white;
        border: 1px solid #ddd;
        border-radius: 4px;
        z-index: 1;
        user-select: none;

        &.active {
          display: block;
        }

        & a {
          color: var(--text);
          padding: 0.5rem 1rem;
          display: block;
          text-decoration: none;
          transition: all 0.2s ease-in-out;

          &:hover {
            background-color: color-mix(in srgb, #fff, var(--secondary) 50%);
          }
        }
      }
    </style>
  </div>
</footer>
